{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  // Ignore any repository config presets
  "ignorePresets": [":all"],
  // Force these settings to override any repository config
  "force": {
    "customManagers": [
      {
        "customType": "regex",
        // Track OpenSCAD nightly version in install script
        "fileMatch": ["^tools/install-openscad\\.sh$"],
        "matchStrings": [
          "# renovate: datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)( versioning=(?<versioning>\\S+))?\\nOPENSCAD_NIGHTLY_VERSION_(?:WINDOWS|LINUX)=\"(?<currentValue>.*?)\""
        ],
        "datasourceTemplate": "custom.openscad-snapshots",
        "versioningTemplate": "loose"
      },
      {
        "customType": "regex",
        // Track OpenSCAD stable version in install script
        "fileMatch": ["^tools/install-openscad\\.sh$"],
        "matchStrings": [
          "# renovate: datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)\\nOPENSCAD_STABLE_VERSION=\"(?<currentValue>.*?)\""
        ],
        "datasourceTemplate": "github-releases",
        "versioningTemplate": "loose"
      },
      {
        "customType": "regex",
        // Track BOSL2 commit hash in dependencies script
        "fileMatch": ["^tools/install-dependencies\\.sh$"],
        "matchStrings": [
          "# renovate: datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)( versioning=(?<versioning>\\S+))?\\nBOSL2_VERSION=\"(?<currentValue>.*?)\""
        ],
        "datasourceTemplate": "github-commits",
        "versioningTemplate": "loose"
      }
    ]
  },
  // Custom datasource for OpenSCAD nightly snapshots
  "customDatasources": {
    "openscad-snapshots": {
      "defaultRegistryUrlTemplate": "https://files.openscad.org/snapshots/",
      "format": "html"
    }
  },
  // Package rules to extract version from OpenSCAD snapshot filenames
  "packageRules": [
    {
      "matchDatasources": ["custom.openscad-snapshots"],
      "extractVersion": "^OpenSCAD-(?<version>\\d{4}\\.\\d{2}\\.\\d{2}(?:\\.ai\\d+)?)",
      "groupName": "OpenSCAD nightly",
      "groupSlug": "openscad-nightly"
    }
  ]
}

